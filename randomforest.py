import pandas as pd
from sklearn import cross_validation
from sklearn.ensemble import RandomForestClassifier as RFC
import numpy as np
import time

labels = pd.read_csv("E:/normalsoftwares/labels.csv")
features = pd.read_csv("E:/normalsoftwares/subtrain40_10features200timesup_3gram.csv")
train = pd.merge(labels, features, on="Id")

labels = train.Class
train.drop(["Id", "Class"], axis=1, inplace=True)
train = train.as_matrix()


f = open("E:/log.txt", "a")
print >> f, ""
print >> f, time.strftime("%Y-%m-%d %H:%M:%S", time.localtime(time.time()))
print >> f, "[sub40_10, 0-1 class] [opcode 3 gram [select features which up 200 times or more] [randomforest classifier with 100 trees]"
f.close()
list = []
n=10
for i in range(n):
    X_train, X_test, y_train, y_test = cross_validation.train_test_split(train, labels, test_size=0.3)
    rfc = RFC(n_estimators=100, n_jobs=-1)
    rfc.fit(X_train, y_train)
    score = rfc.score(X_test, y_test)
    list.append(score)

f = open("E:/log.txt", "a")
avg = np.mean(list)
for i in range(len(list)):
    list[i] = round(list[i], 4)
print >> f, "scores in", len(list), "rounds:", list
print >> f, "avg score:", round(avg, 5)
f.close()